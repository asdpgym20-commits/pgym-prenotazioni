{% extends "base.html" %}
{% block content %}
<h1>{{ cs.title }}</h1>
<p class="mb-1"><strong>Data:</strong> {{ cs.date.strftime('%d/%m/%Y') }}</p>
<p class="mb-1"><strong>Orario:</strong> {{ cs.start_time.strftime('%H:%M') }}–{{ cs.end_time.strftime('%H:%M') }}</p>
<p class="mb-3"><strong>Coach:</strong> {{ cs.coach or '-' }} • <strong>Luogo:</strong> {{ cs.location or '-' }}</p>
<p><strong>Capienza:</strong> {{ cs.capacity }} • <strong>Posti liberi:</strong> {{ cs.capacity - cs.bookings|length }}</p>

<h5>Prenotati ({{ cs.bookings|length }})</h5>
{% if not cs.bookings %}
  <p>Nessuno ancora prenotato.</p>
{% else %}
  <ul class="list-group mb-3">
    {% for b in cs.bookings %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <div>
        <strong>{{ b.member.name }}</strong>
        <small class="text-muted"> — {{ b.member.email or '—' }} — {{ b.member.phone or '—' }}</small>
      </div>
      <div class="d-flex gap-2">
        <a class="btn btn-sm btn-outline-primary" href="{{ url_for('ics_booking', booking_id=b.id) }}">.ics</a>
        <form method="post" action="{{ url_for('cancel', booking_id=b.id) }}" onsubmit="return confirm('Cancellare la prenotazione di {{ b.member.name }}?');">
          <button class="btn btn-sm btn-outline-danger">Cancella</button>
        </form>
      </div>
    </li>
    {% endfor %}
  </ul>
{% endif %}

<a class="btn btn-primary" href="{{ url_for('book', class_id=cs.id) }}">Aggiungi prenotazione</a>
<a class="btn btn-outline-secondary" href="{{ url_for('admin') }}">Torna all'admin</a>
{% endblock %}
